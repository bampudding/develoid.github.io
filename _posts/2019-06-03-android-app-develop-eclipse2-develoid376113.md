---
layout: post
title: '"아마도 쉬운 안드로이드 어플만들기" [40] ~키가 눌렸을 때 (onPressed)'
author: '달팽이들'
categories: Android-App-Develop(Eclipse2)
tags:
- Android
- App
- Develop
- Eclipse
---


<script> location.href='https://cafe.naver.com/develoid/376113' ; </script>


















						<p>&nbsp;</p><p>&nbsp;<img src="https://dthumb-phinf.pstatic.net/?src=%22http%3A%2F%2Fpostfiles3.naver.net%2F20130523_178%2Ftjdtnsu_1369283538974akCh1_JPEG%2Fand.jpg%3Ftype%3Dw2%22&amp;type=cafe_wa740"> </p><div><div><div><div><p><i>퍼갈 때에는 반드시 저작자의 허락과 저작자의 이름(아이디)를 기록하어야 합니다.</i></p><p><i>저작자는 Snails(tjdtnsu)입니다.</i></p><p><span><strong><span>제발 덧글 좀 적어주세요. 강의 적는 시간은 1시간이지만 덧글은 1분도 걸리지 않습니다.</span></strong></span></p><p><u>참고 : 이 강좌는 초보자를 위한 Eclipse를 사용하였습니다.</u></p><p><u>올리는 곳 : 제 네이버 블로그, 디벨로이드 카페</u> </p><div><span><u><strong>업로드 시간 :&nbsp;매달 2,4주 오후 11시</strong></u> <div></div><p>&nbsp;<strong><span>난이도 : ★</span><span>★★★★</span></strong></p></span></div><p></p><p></p></div></div></div></div><p>&nbsp;</p><p>&nbsp;</p><p>오늘은 앱 만드는데 거의 필수적인</p><p>'~키가 눌렸을 때'와 관련된 코딩을 하겠습니다.</p><p>&nbsp;</p><p>그 중 오늘은 백 키를 두 번 눌리면 종료하는 걸 해보겠습니다.&nbsp;&nbsp;&nbsp;&nbsp; 참고자료 : <a href="http://cafe.naver.com/develoid/110822">여기</a></p><p>&nbsp;</p><table style="border-width: 1px 1px 0px 0px; border-style: solid solid none none; border-color: rgb(204, 204, 204) rgb(204, 204, 204) currentColor currentColor;" class="__se_tbl" border="0" cellspacing="0" cellpadding="0"><tbody><tr><td style="border-width: 0px 0px 1px 1px; border-style: none none solid solid; border-color: currentColor currentColor rgb(204, 204, 204) rgb(204, 204, 204); width: 738px; height: 558px; background-color: rgb(255, 255, 255);"><p>&nbsp;public class SelectActivity extends Activity {<b>&nbsp; <span>private static final int MSG_TIMER_EXPIRED = 1;</span><b><span>&nbsp; private static final int Second = 2000;</span><b><span>&nbsp; private boolean K = false;</span><b><span>&nbsp; private long&nbsp;b = 0;</span></p><p>&nbsp;</p><p>&nbsp;@Override<b>&nbsp;protected void onCreate(Bundle savedInstanceState) {<b>&nbsp;&nbsp;super.onCreate(savedInstanceState);<b>&nbsp;&nbsp;setContentView(R.layout.activity_select);<b>&nbsp;}<b>&nbsp;<b>&nbsp;<span>public void onBackPressed() {&nbsp;</span></p><p><span></span><span>&nbsp;&nbsp;&nbsp; if (K == false) {&nbsp;</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp; K = true;&nbsp;<span> </span></span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp; mCurrTimeInMillis = Calendar.getInstance().getTimeInMillis();</span></p><p><span>&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp; Toast.makeText(this, "종료를 원하시면 한번 더 누르세요",</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Toast.LENGTH_LONG).show();</span></p><p><span>&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp; startTimer();&nbsp;</span></p><p><span></span><span>&nbsp;&nbsp;&nbsp; } else {</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp; mIsBackKeyPressed = false;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp; if (Calendar.getInstance().getTimeInMillis() &lt;= b+Second ) { </span><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; finish();</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp; }</span><b><span>&nbsp;&nbsp;&nbsp; }</span><b><span>&nbsp;&nbsp; }</span></p><p><span>&nbsp;&nbsp; </span></p><p><span>&nbsp;&nbsp; private void startTimer() {</span><b><span>&nbsp;&nbsp;&nbsp; mTimerHandler.sendEmptyMessageDelayed(MSG_TIMER_EXPIRED,</span><span>Second);</span><b><span>&nbsp;&nbsp; }</span></p><p><span>&nbsp;&nbsp; </span></p><p><span>&nbsp;&nbsp; private Handler mTimerHandler = new Handler() {</span><b><span>&nbsp;&nbsp;&nbsp; public void handleMessage(Message msg) {</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp; switch (msg.what) {</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp; case MSG_TIMER_EXPIRED: {</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K = false;</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp; }</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp; }</span><b><span>&nbsp;&nbsp;&nbsp; }</span><b><span>&nbsp;&nbsp; };</span></p><p>&nbsp;</p><p>&nbsp;</p></td></tr></tbody></table><p>&nbsp;</p><p>이제 해석을 해 봅시다</p><p>&nbsp;</p><p><span>public void onBackPressed() {&nbsp;</span></p><p><span></span><span>&nbsp;&nbsp;&nbsp; if (K == false) {&nbsp;</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp; K = true;&nbsp;<span> </span></span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp; mCurrTimeInMillis = Calendar.getInstance().getTimeInMillis();</span></p><p><span>&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp; Toast.makeText(this, "종료를 원하시면 한번 더 누르세요",</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Toast.LENGTH_LONG).show();</span></p><p><span>&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp; startTimer();&nbsp;</span></p><p>일단 Back 키가 눌렀을 때</p><p>K라는 변수를 통해 다시 눌려졌는지 확인합니다.</p><p>K라는 boolean 변수가 참이 아닐 때(시간 내 처음 누를 때시간을 재기 위해서)</p><p>K를 참으로 합니다.</p><p>그 뒤 현재시간을 넣고</p><p>한번 더 누르면 종료된다는 메세지가 출력합니다.</p><p>setTimer 함수를 실행하는데, 이게 좀 중요합니다.(좀 있다가)</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>} else {<b><span>&nbsp;&nbsp;&nbsp;&nbsp; mIsBackKeyPressed = false;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp; if (Calendar.getInstance().getTimeInMillis() &lt;= mCurrTimeInMillis + Second) { </span><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; finish();</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp; }</span><b><span>&nbsp;&nbsp;&nbsp; }</span><b><span>&nbsp;&nbsp; }</span><b>아닐 때는 눌렀는데, 시간 안에 눌려진 상태라는 거겠죠</p><p>이것을 확인을 합니다. 여기서 조건이 만족한다면 종료</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;&nbsp; private void startTimer() {<b><span>&nbsp;&nbsp;&nbsp; mTimerHandler.sendEmptyMessageDelayed(MSG_TIMER_EXPIRED,</span><span>Second);</span><b><span>&nbsp;&nbsp; }</span></p><p><span>&nbsp;&nbsp; </span></p><p><span>&nbsp;&nbsp; private Handler mTimerHandler = new Handler() {</span><b><span>&nbsp;&nbsp;&nbsp; public void handleMessage(Message msg) {</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp; switch (msg.what) {</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp; case MSG_TIMER_EXPIRED: {</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K = false;</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp; }</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</span><b><span>&nbsp;&nbsp;&nbsp;&nbsp; }</span><b><span>&nbsp;&nbsp;&nbsp; }</span><b><span>&nbsp;&nbsp; };</span></p><p><span><span>﻿마지막 부분입니다. 여기는 시간이 다 되면 다시 K를 false로 만들어놓습니다.</span></span></p><p><span><span>그 외에는 별 부분이.... 없네요</span></span></p><p><span><span></span></span>&nbsp;</p><p><span><span></span></span>&nbsp;</p><p><span><span></span></span>&nbsp;</p><p><span><span></span></span>&nbsp;</p><p><span><span></span></span>&nbsp;</p><p><span><span>뭐 어쨌든 도움이 되는 부분이긴 합니다.</span></span></p><p><span><span>다음은 랜덤에 대해 알아보겠습니다.</span></span></p><p><span><span></span></span>&nbsp;</p><p><span><span></span></span>&nbsp;</p><p><span><span></span></span>&nbsp;</p><p><span><span></span></span>&nbsp;</p><p><span><span>cf) 강좌 할 것 추천해주세요</span></span></p>
